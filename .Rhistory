install.packages("dplyr")
library(dplyr)
library(ggplot2)
library(plotly)
library(RColorBrewer)
library(stringr)
Sys.setlocale(category = "LC_ALL", locale = "C")
killings_data1 <- read.csv("police_killings.csv", stringsAsFactors = F)
killings_data1$raceethnicity <- factor(killings_data1$raceethnicity,
levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"),
labels = c("darkred", "midnightblue", "paleturquoise4", "lightsalmon3"))
killings_data1$gender <- factor(killings_data1$gender,
levels = c("Male", "Female"),
labels = c("red", "blue"))
killings_data1$cause <- factor(killings_data1$cause,
levels = c("Gunshot", "Taser", "Death in custody", "Struck by vehicle"),
labels = c("red", "blue", "green", "black"))
build_map <- function(df) {
g <- list(
scope = "usa",
projection = list(type = "albers usa"),
showland = TRUE,
landcolor = toRGB("gray85"),
subunitwidth = 1,
countrywidth = 1,
subunitcolor = toRGB("white"),
countrycolor = toRGB("white")
)
p <- plot_geo(df, locationmode = "USA-states") %>%
add_markers(
x = df$longitude, y = df$latitude,
color = ~I(df$raceethnicity),
text = paste0(df$name, "
", df$city, ", ",df$state, "
", df$month, " ", df$day),
marker = list(
size = 5,
mode = "markers"
)) %>%
colorbar(title = "hi") %>%
layout(title = "Police Killings in 2015", geo = g)
p
}
build_map(killings_data1)
setwd("~/Documents/info201-group-project")
Sys.setlocale(category = "LC_ALL", locale = "C")
killings_data1 <- read.csv("police_killings.csv", stringsAsFactors = F)
killings_data1$raceethnicity <- factor(killings_data1$raceethnicity,
levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"),
labels = c("darkred", "midnightblue", "paleturquoise4", "lightsalmon3"))
killings_data1$gender <- factor(killings_data1$gender,
levels = c("Male", "Female"),
labels = c("red", "blue"))
killings_data1$cause <- factor(killings_data1$cause,
levels = c("Gunshot", "Taser", "Death in custody", "Struck by vehicle"),
labels = c("red", "blue", "green", "black"))
build_map <- function(df) {
g <- list(
scope = "usa",
projection = list(type = "albers usa"),
showland = TRUE,
landcolor = toRGB("gray85"),
subunitwidth = 1,
countrywidth = 1,
subunitcolor = toRGB("white"),
countrycolor = toRGB("white")
)
p <- plot_geo(df, locationmode = "USA-states") %>%
add_markers(
x = df$longitude, y = df$latitude,
color = ~I(df$raceethnicity),
text = paste0(df$name, "
", df$city, ", ",df$state, "
", df$month, " ", df$day),
marker = list(
size = 5,
mode = "markers"
)) %>%
colorbar(title = "hi") %>%
layout(title = "Police Killings in 2015", geo = g)
p
}
build_map(killings_data1)
killings_data <- read.csv("police_killings.csv", stringsAsFactors = F)
install.packages("leaflet")
build_map2 <- function(df) {
map <- leaflet(df) %>%
addTiles() %>%
map
}
build_map2(killings_data)
library(leaflet)
build_map2 <- function(df) {
map <- leaflet(df) %>%
addTiles() %>%
map
}
build_map2(killings_data)
map <- leaflet(killings_data) %>%
addTiles()
map <- leaflet(killings_data) %>%
addTiles() %>%
addCircleMarkers()
map
map <- leaflet(killings_data) %>%
addTiles() %>%
addCircleMarkers(radius = 1)
map
map <- leaflet(killings_data) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name, "
", df$city, ", ",df$state, "
", df$month, " ", df$day))
map
df <- read.csv("police_killings.csv", stringsAsFactors = F)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name, "
", df$city, ", ",df$state, "
", df$month, " ", df$day))
map
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name, "", df$city, ", ",df$state, "", df$month, " ", df$day))
map
library(leaflet)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name, "
", df$city, ", ",df$state, "
", df$month, " ", df$day))
map
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste(sep = "<br/>", df$name, df$city, df$state, df$month, df$day))
map
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste(sep = "\n", df$name, df$city, df$state, df$month, df$day))
map
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste(df$name, df$city, ",", df$state, df$month, df$day))
map
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month, df$day))
map
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day))
map
df$raceethnicity <- factor(df$raceethnicity, levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"))
factpal <- colorFactor(topo.colors(4), df$raceethnicity)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day), color = ~factpal(raceethnicity))
map
View(df)
df$raceethnicity <- factor(df$raceethnicity, levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"))
factpal <- colorFactor(topo.colors(4), df$raceethnicity)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day), color = ~factpal(raceethnicity)) %>%
addLegend(position = "bottomright", pal = factpal, values = ~raceethnicity)
map
df$raceethnicity <- factor(df$raceethnicity, levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"))
factpal <- colorFactor(topo.colors(4), df$raceethnicity)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day), color = ~factpal(raceethnicity), opacity = .7) %>%
addLegend(position = "bottomright", pal = factpal, values = ~raceethnicity)
map
View(df)
Sys.setlocale(category = "LC_ALL", locale = "C")
df <- read.csv("police_killings.csv", stringsAsFactors = F)
colnames(df)[4] <- "race/ethnicity"
View(df)
Sys.setlocale(category = "LC_ALL", locale = "C")
df <- read.csv("police_killings.csv", stringsAsFactors = F)
colnames(df)[4] <- "race/ethnicity"
library(leaflet)
df$raceethnicity <- factor(df$race/ethnicity, levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"))
factpal <- colorFactor(topo.colors(4), df$race/ethnicity)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day), color = ~factpal(race/ethnicity), opacity = .7) %>%
addLegend(position = "bottomleft", pal = factpal, values = ~race/ethnicity)
map
library(leaflet)
df$race/ethnicity <- factor(df$race/ethnicity, levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"))
factpal <- colorFactor(topo.colors(4), df$race/ethnicity)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day), color = ~factpal(race/ethnicity), opacity = .7) %>%
addLegend(position = "bottomleft", pal = factpal, values = ~race/ethnicity)
map
Sys.setlocale(category = "LC_ALL", locale = "C")
df <- read.csv("police_killings.csv", stringsAsFactors = F)
colnames(df)[4] <- "race/ethnicity"
library(leaflet)
df$race/ethnicity <- factor(df$race/ethnicity, levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"))
factpal <- colorFactor(topo.colors(4), df$race/ethnicity)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day), color = ~factpal(race/ethnicity), opacity = .7) %>%
addLegend(position = "bottomleft", pal = factpal, values = ~race/ethnicity)
map
Sys.setlocale(category = "LC_ALL", locale = "C")
df <- read.csv("police_killings.csv", stringsAsFactors = F)
colnames(df)[4] <- "race/ethnicity"
library(leaflet)
df$race/ethnicity <- factor(df$race/ethnicity, levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"))
factpal <- colorFactor(topo.colors(4), df$race/ethnicity)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day), color = ~factpal(df$race/ethnicity), opacity = .7) %>%
addLegend(position = "bottomleft", pal = factpal, values = ~race/ethnicity)
map
Sys.setlocale(category = "LC_ALL", locale = "C")
df <- read.csv("police_killings.csv", stringsAsFactors = F)
colnames(df)[4] <- "race/ethnicity"
library(leaflet)
df$race/ethnicity <- factor(df$race/ethnicity, levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"))
factpal <- colorFactor(topo.colors(4), df$race/ethnicity)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day), color = ~factpal("race/ethnicity"), opacity = .7) %>%
addLegend(position = "bottomleft", pal = factpal, values = ~race/ethnicity)
map
Sys.setlocale(category = "LC_ALL", locale = "C")
df <- read.csv("police_killings.csv", stringsAsFactors = F)
colnames(df)[4] <- "raceethnicity"
library(leaflet)
df$raceethnicity <- factor(df$raceethnicity, levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"))
factpal <- colorFactor(topo.colors(4), df$raceethnicity)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day), color = ~factpal(raceethnicity), opacity = .7) %>%
addLegend(position = "bottomleft", pal = factpal, values = ~raceethnicity)
map
library(leaflet)
df$raceethnicity <- factor(df$raceethnicity, levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"))
factpal <- colorFactor(topo.colors(4), df$raceethnicity)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day), color = ~factpal(raceethnicity), opacity = .7) %>%
addLegend(position = "bottomleft", pal = factpal, values = ~raceethnicity,
title = "Race/Ethnicity of Victim")
library(leaflet)
df$raceethnicity <- factor(df$raceethnicity, levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"))
factpal <- colorFactor(topo.colors(4), df$raceethnicity)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day), color = ~factpal(raceethnicity), opacity = .7) %>%
addLegend(position = "bottomleft", pal = factpal, values = ~raceethnicity,
title = "Race/Ethnicity of Victim")
map
Sys.setlocale(category = "LC_ALL", locale = "C")
df <- read.csv("police_killings.csv", stringsAsFactors = F)
library(leaflet)
df$raceethnicity <- factor(df$raceethnicity, levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"))
factpal <- colorFactor(topo.colors(4), df$raceethnicity)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day), color = ~factpal(raceethnicity), opacity = .7) %>%
addLegend(position = "bottomleft", pal = factpal, values = ~raceethnicity,
title = "Race/Ethnicity of Victim")
map
build_map <- function(df) {
library(leaflet)
df$raceethnicity <- factor(df$raceethnicity, levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"))
factpal <- colorFactor(topo.colors(4), df$raceethnicity)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day), color = ~factpal(raceethnicity), opacity = .7) %>%
addLegend(position = "bottomleft", pal = factpal, values = ~raceethnicity,
title = "Race/Ethnicity of Victim")
map
}
shiny::runApp()
library(shiny)
library(plotly)
library(shinythemes)
shinyUI(navbarPage(theme = shinytheme("paper"),
"Who Police Killed and Where in 2015",
tags$h3("In 2015..."),
tags$p("Police killed 467 Americans. Some came from opulent backgrounds,
others from places historically under the poverty line. Some were students, parents, or employees. Some were young, old, or somewhere
in between. Some were armed and some were not.
What each of them will not be is forgotten. Using data from the statistical website fivethirtyeight that merged the Guardian's data on police killings
in 2015 with Census data, each victim will not be just a point. Each victim will
be a part of a bigger puzzle, to try to find clarity and make sense of the devastating killings that have occured. By exploring and representation facets of the victim's
background and the demographics surrounding the location of the killing, we hope that
the relationships between these factors will reveal themselves."),
# Create a tab panel for your map
tabPanel(
"Map",
# Create sidebar layout
sidebarLayout(
# Side panel for controls
sidebarPanel(
tags$h3("All Police Killings in 2015"),
tags$h6("Hover for more details about each specific killing."),
# Input to select variable to map
selectInput(
"shooting_var",
label = "Variable to Color Each Point",
choices = list(
"Race/Ethnicity" = "raceethnicity",
"Gender" = "gender",
"Cause of Death" = "cause"
)
)
),
# Main panel: display plotly map
mainPanel(
plotlyOutput("Map"),
#tags$link(rel = "stylesheet", type = "text/css", href = "style.css"),
#tags$div(class = "summary", checked = NA,
tags$p("This map shows each killing at the hands of police in 2015. The selected
variable will affect the color of each point representing each killing with the
legend provided to the right.")
)
)
),
tabPanel("other",
tags$h1("Filler page")
)
# Create a tabPanel to show your scatter plot
))
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day), color = ~factpal(raceethnicity), opacity = .7) %>%
addLegend(position = "bottomleft", pal = factpal, values = ~raceethnicity,
title = "Race/Ethnicity of Victim")
map
runApp()
runApp()
library(dplyr)
df <- read.csv("police_killings.csv", stringsAsFactors = F)
source(file = "Map Plot.R")
shinyServer(function(input, output) {
# Render a plotly object that returns your map
output$map <- renderLeaflet({
return(build_map(df))
})
})
runApp()
build_map(df)
library(dplyr)
library(ggplot2)
library(plotly)
library(RColorBrewer)
library(stringr)
Sys.setlocale(category = "LC_ALL", locale = "C")
df <- read.csv("police_killings.csv", stringsAsFactors = F)
build_map <- function(df) {
library(leaflet)
df$raceethnicity <- factor(df$raceethnicity, levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"))
factpal <- colorFactor(topo.colors(4), df$raceethnicity)
map <- leaflet(df) %>%
addTiles() %>%
addCircleMarkers(radius = 1, label = paste0(df$name,"
",df$city, ", ", df$state,"
", df$month," ", df$day), color = ~factpal(raceethnicity), opacity = .7) %>%
addLegend(position = "bottomleft", pal = factpal, values = ~raceethnicity,
title = "Race/Ethnicity of Victim", na.label = "Not Collected")
map
}
build_map(df)
df$raceethnicity <- factor(df$raceethnicity, levels = c("Black", "White", "Hispanic/Latino",
"Asian/Pacific Islander"))
df$gender <- factor(killings_data1$gender,
levels = c("Male", "Female"))
df$cause <- factor(killings_data1$cause,
levels = c("Gunshot", "Taser", "Death in custody", "Struck by vehicle"))
runApp()
runApp()
